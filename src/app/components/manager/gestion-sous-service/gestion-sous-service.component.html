<div class="background-overlay"  *ngIf="showPopup || showUpdatePopup" (click)="closePopup()"></div>

<div class="piece-container">
  <div class="piece">
    <div class="piece">
      <h2>Spus-service</h2>
      <button type="button" class="submit-btn" (click)="openAddPopup()">Ajouter</button>
    </div>
  </div>

  <div class="popup" *ngIf="showPopup">
    <div class="popup-content">
      <span class="close-btn" (click)="closePopup()">&times;</span>
      <h2>Ajouter un Parking</h2>
      <form (ngSubmit)="AddSousService()" #addSousServiceForm="ngForm">
        <div class="contain-input">

          <div class="input-group">
            <label for="nom_sous_service">nom sous-service</label>
            <input type="text" name="nom_sous_service"
            id="nom_sous_service" placeholder="Entrez le marque "
            [(ngModel)]="elementForm.nom_sous_service" required>
          </div>

          <div class="input-group">
            <label for="marque">Service :</label>
            <select name="marque" [(ngModel)]="elementForm.id_service" required >
              <option value="default" selected>-- Sélectionnez une option --</option>
              @for (service of services; track $index) {
                <option value="{{service._id}}" >{{service.nom_service}}</option>
              }
            </select>
          </div>

          <div class="input-group">
            <label for="tarif">tarif</label>
            <input type="number" name="tarif"
            id="tarif" placeholder="Entrez le tarif "
            [(ngModel)]="elementForm.tarif" required>
          </div>

        </div>
        <button type="submit" class="submit-btn" [disabled]="addSousServiceForm.invalid">Ajouter</button>
      </form>
    </div>
  </div>

  <!-- Popup pour la mise à jour -->
  <div class="popup" *ngIf="showUpdatePopup">
    <div class="popup-content">
      <span class="close-btn" (click)="closePopup()">&times;</span>
      <h2>Modifier </h2>
      <form (ngSubmit)="updateSousService()" #updateModelForm="ngForm">
        <div class="contain-input">
          <div class="input-group">
            <label for="nom_sous_service">nom sous-service</label>
            <input type="text" name="nom_sous_service" id="nom_sous_service" placeholder="Entrez le nom de la model" [(ngModel)]="updateForm.nom_sous_service" required>
          </div>
          <div class="input-group">
            <label for="marque">Services :</label>
            <select name="marque" [(ngModel)]="updateForm.id_service" required>
              <option value="" disabled>-- Sélectionnez une option --</option>
              <option *ngFor="let service of services" [value]="service._id">
                {{ service.nom_service }}
              </option>
            </select>
          </div>

        </div>
        <button type="submit" class="submit-btn" [disabled]="updateModelForm.invalid">Modifier</button>
      </form>
    </div>
  </div>

  <!-- Liste des Modele -->
  <div class="piece-list">
    <div class="service" *ngFor="let sous_service of sous_services;">
      <div class="service-description">
        <h2>{{ sous_service.nom_sous_service }}</h2>
        <p>{{ sous_service.id_service }}</p>
        <p>{{ sous_service.tarif }}</p>
      </div>
      <button (click)="deleteSousService(sous_service._id)">Supprimer</button>
      <button type="button" class="submit-btn" (click)="openUpdatePopup(sous_service)">Update</button>
    </div>

    <div class="service">
      <div class="service-description">
        <h2> service</h2>
        <p>sous service</p>
        <p>1000</p>
      </div>
      <button class="submit-btn-delete">Delete</button>
      <button type="button" class="submit-btn-update" >Update</button>
    </div>
    <div class="service">
      <div class="service-description">
        <h2> service</h2>
        <p>sous service</p>
        <p>1000</p>
      </div>
      <button class="submit-btn-delete">Delete</button>
      <button type="button" class="submit-btn-update" >Update</button>
    </div>
    <div class="service">
      <div class="service-description">
        <h2> service</h2>
        <p>sous service</p>
        <p>1000</p>
      </div>
      <button class="submit-btn-delete">Delete</button>
      <button type="button" class="submit-btn-update" >Update</button>
    </div>
  </div>
</div>
